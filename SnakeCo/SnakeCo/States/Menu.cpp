#include "stdafx.h"

#include "Menu.h"
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////КОНСТРУКТОР/////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Cls_Menu::Cls_Menu()
{
	//Зацикленное значение и две основных кнопки
	NumberButton.SetMinMax( 0, 1 );
	Buttons = new Str_Object[ 2 ];
	//Тоже самое, но для суб кнопок с выбором сложности
	ShowSubButtons = false;
	NumberSubButton.SetMinMax( 0, 2 );
	SubButtons = new Str_Object[ 3 ];
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////ДЕСТРУКТОР//////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Cls_Menu::~Cls_Menu()
{
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////ЗАГРУЗКА ИЗОБРАЖЕНИЙ////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void Cls_Menu::Loading( Str_Geminus< unsigned int > &FieldSizes )
{
	MainField.Init( FieldSizes );

	Title.Name =  "              (`  ).                   _               \n";
	Title.Name += "             (     ).              .:(`  )`.           \n";
	Title.Name += ")           _(       '`.          :(   .    )          \n";
	Title.Name += "        .=(`(      .   )     .--  `.  (    ) )         \n";
	Title.Name += "       ((    (..__.:'-'   .+(   )   ` _`  ) )          \n";
	Title.Name += "`.     `(       ) )       (   .  )     (   )  ._       \n";
	Title.Name += "  )      ` __.:'   )     (   (   ))     `-'.-(`  )     \n";
	Title.Name += ")  )  ( )       --'       `- __.'         :(      ))   \n"; 
	Title.Name += ".-'  (_.'          .')                    `(    )  ))  \n";
	Title.Name += "                  (_  )                     ` __.:'    \n";
	Title.Name += "														  \n";
	Title.Name += "--..,___.--,--'`,---..-.--+--.,,-,,..._.--..-._.-a:f--.\n";

	Title.Koordinates.Primis = ( FieldSizes.Primis - Title.Name.length() / 12 ) / 2;
	Title.Koordinates.Secundus = 1;

	GameName.Name = "SNAKE GAME";
	GameName.Koordinates.Primis = ( FieldSizes.Primis - GameName.Name.length() ) / 2;
	GameName.Koordinates.Secundus = Title.Koordinates.Secundus + 13;

	Buttons[ 0 ].Name = "Start";
	Buttons[ 0 ].Koordinates.Primis = ( FieldSizes.Primis - Buttons[ 0 ].Name.length() ) / 2;
	Buttons[ 0 ].Koordinates.Secundus = GameName.Koordinates.Secundus + 2;

	Buttons[ 1 ].Name = "Exit";
	Buttons[ 1 ].Koordinates.Primis = ( FieldSizes.Primis - Buttons[ 0 ].Name.length() ) / 2;
	Buttons[ 1 ].Koordinates.Secundus = Buttons[ 0 ].Koordinates.Secundus + 2;

	Marker.Name = "->";
	Marker.Koordinates.Primis = Buttons[ 0 ].Koordinates.Primis - Marker.Name.length();
	Marker.Koordinates.Secundus = Buttons[ 0 ].Koordinates.Secundus;

	SubButtons[ 0 ].Name = "Easy";
	SubButtons[ 0 ].Koordinates.Primis = ( FieldSizes.Primis - SubButtons[ 0 ].Name.length() ) / 2;
	SubButtons[ 0 ].Koordinates.Secundus = GameName.Koordinates.Secundus + 2;

	SubButtons[ 1 ].Name = "Medium";
	SubButtons[ 1 ].Koordinates.Primis = ( FieldSizes.Primis - SubButtons[ 0 ].Name.length() ) / 2;
	SubButtons[ 1 ].Koordinates.Secundus = SubButtons[ 0 ].Koordinates.Secundus + 2;

	SubButtons[ 2 ].Name = "Hard";
	SubButtons[ 2 ].Koordinates.Primis = ( FieldSizes.Primis - SubButtons[ 0 ].Name.length() ) / 2;
	SubButtons[ 2 ].Koordinates.Secundus = SubButtons[ 1 ].Koordinates.Secundus + 2;
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////ОБРАБОТКА НАЖАТИЙ КЛАВИАТУРЫ///////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void Cls_Menu::KeyBoardEvents( int SomeButton )
{
	//Массивы с кодами для проверок
	unsigned int MoveUp[] = { 72, 75};
	unsigned int MoveDown[] = { 77, 80 };
	if( ShowSubButtons )
	{
		//Смещаем маркер для кнопок
		//Вверх
		if( Compare( SomeButton, MoveUp, 2 ) > -1 )
		{
			NumberSubButton.AddValue( -1 );		
		}
		//Вниз
		if( Compare( SomeButton, MoveDown, 2 ) > -1 )
		{
			NumberSubButton.AddValue( 1 );
		}
		Marker.Koordinates.Secundus = SubButtons[ NumberSubButton.GetValue() ].Koordinates.Secundus;

		//Escape
		if( SomeButton == 27 && ShowSubButtons )
		{
			Marker.Koordinates.Secundus = Buttons[ NumberButton.GetValue() ].Koordinates.Secundus;
			ShowSubButtons = false;
			return;
		}		
		
		if( ( NumberSubButton.GetValue() + 1 ) && SomeButton == 13 )
		{			
			ChangeState( STATE_LEVEL, NumberSubButton.GetValue(), 1, false );
		}
	}
	else
	{
		//Смещаем маркер для кнопок
		if( Compare( SomeButton, MoveUp, 2 ) > -1 )
		{
			NumberButton.AddValue( -1 );		
		}
		if( Compare( SomeButton, MoveDown, 2 ) > -1 )
		{
			NumberButton.AddValue( 1 );
		}
		Marker.Koordinates.Secundus = Buttons[ NumberButton.GetValue() ].Koordinates.Secundus;

		if( SomeButton == 27 )
		{
			ChangeState( STATE_EXIT, 1, 1, false );
		}
		if( NumberButton.GetValue() == 1 && SomeButton == 13 )
		{
			ChangeState( STATE_EXIT, 1, 1, false );
		}
		if( NumberButton.GetValue() == 0 && SomeButton == 13 )
		{
			//Marker.Koordinates.Primis = SubButtons[ NumberSubButton.GetValue() ].Koordinates.Primis - Marker.Name.length();
			Marker.Koordinates.Secundus = SubButtons[ NumberSubButton.GetValue() ].Koordinates.Secundus;
			ShowSubButtons = true;
			return;
		}
	}
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////ОБРАБОТКА ЛОГИКИ ИГРЫ//////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void Cls_Menu::Logic()
{	
}
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////ОТОБРАЗИТЬ МЕНЮ И ДРУГИХ ОБЪЕКТОВ///////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void Cls_Menu::Render()
{
	PrepareField( MainField );

	CopyObjectToField( Title, MainField );
	CopyObjectToField( GameName, MainField );

	if( ShowSubButtons )
	{
		for( unsigned int i = 0; i < NumberSubButton.GetMax() + 1; ++i )
		{
			CopyObjectToField( SubButtons[ i ], MainField );
		}
	}
	else
	{
		for( unsigned int i = 0; i < NumberButton.GetMax() + 1; ++i )
		{
			CopyObjectToField( Buttons[ i ], MainField );
		}	
	}
	CopyObjectToField( Marker, MainField );

	std::cout << MainField.GetPointerArray();
}
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////